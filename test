import React, { useRef, useState } from 'react';
import {
  Box,
  Button,
  Typography,
  Paper,
  List,
  ListItem,
  ListItemIcon,
  ListItemText,
  Divider,
} from '@mui/material';
import CloudUploadIcon from '@mui/icons-material/CloudUpload';
import InsertDriveFileIcon from '@mui/icons-material/InsertDriveFile';

const FileUploader = () => {
  const fileInputRef = useRef();
  const [selectedFiles, setSelectedFiles] = useState([]);

  const handleFileSelect = (e) => {
    const files = Array.from(e.target.files);
    setSelectedFiles(files);
  };

  const handleUploadClick = () => {
    fileInputRef.current?.click();
  };

  return (
    <Box
      sx={{
        minHeight: '100vh',
        background: 'linear-gradient(to bottom, #f7f1ff, #ffffff)',
        display: 'flex',
        justifyContent: 'center',
        alignItems: 'center',
        py: 6,
      }}
    >
      <Paper
        elevation={6}
        sx={{
          border: '2px dashed #cdbdfc',
          backgroundColor: '#fff',
          px: 5,
          py: 6,
          borderRadius: 4,
          maxWidth: 600,
          width: '100%',
          textAlign: 'center',
        }}
      >
        <Box
          sx={{
            width: 80,
            height: 80,
            mx: 'auto',
            mb: 2,
            borderRadius: '50%',
            background: 'linear-gradient(135deg, #8a4ce5, #b19cd9)',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
          }}
        >
          <CloudUploadIcon sx={{ fontSize: 40, color: '#fff' }} />
        </Box>

        <Typography variant="h5" fontWeight="bold" color="#8a4ce5" gutterBottom>
          Upload Your Files
        </Typography>
        <Typography variant="body2" color="text.secondary" mb={3}>
          Drag & drop your files here or use the button below
        </Typography>

        <input
          type="file"
          hidden
          multiple
          ref={fileInputRef}
          onChange={handleFileSelect}
        />

        <Button
          variant="contained"
          onClick={handleUploadClick}
          sx={{
            backgroundColor: '#8a4ce5',
            ':hover': {
              backgroundColor: '#713ad1',
            },
            px: 4,
            py: 1.5,
            borderRadius: 2,
            fontWeight: 'bold',
            textTransform: 'none',
          }}
        >
          Browse Files
        </Button>

        {selectedFiles.length > 0 && (
          <Box mt={5}>
            <Divider sx={{ mb: 2 }} />
            <Typography
              variant="subtitle1"
              fontWeight="bold"
              color="#8a4ce5"
              mb={2}
            >
              Selected Files
            </Typography>
            <List dense>
              {selectedFiles.map((file, index) => (
                <ListItem key={index}>
                  <ListItemIcon>
                    <InsertDriveFileIcon sx={{ color: '#8a4ce5' }} />
                  </ListItemIcon>
                  <ListItemText
                    primary={file.name}
                    secondary={`${(file.size / 1024).toFixed(2)} KB`}
                  />
                </ListItem>
              ))}
            </List>
          </Box>
        )}
      </Paper>
    </Box>
  );
};

export default FileUploader;
